@model Amritnagar.Models.ViewModel.MemDepositeFundDetailListViewModel

@{
    ViewBag.Title = "MemDepositeFundDetailList";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<style>
    .size {
        width: 180px;
        height: 25px;
    }

    .size2 {
        width: 150px;
        height: 25px;
        background-color: white
    }

    .size1 {
        width: 150px;
        height: 25px;
    }

    .sizeM {
        width: 100px;
        height: 25px;
    }

    .sizeS {
        width: 50px;
        height: 25px;
    }

    .sizeL {
        width: 180px;
        height: 25px;
    }

    .sizebig {
        width: 300px;
        height: 25px;
    }

    .heading {
        font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
        color: saddlebrown;
        font-size: 30px;
        text-align: center;
    }

    .tab {
        font-family: Arial, Helvetica, sans-serif;
        font-size: 12px;
        border-collapse: collapse;
        width: 910px;
        margin-left: auto;
        margin-right: auto;
    }

        .tab tbody {
            display: block;
            width: 910px;
            overflow: auto;
            height: 280px;
            text-align: center;
        }

        .tab td, .tab th {
            border: 1px solid #ddd;
            padding: 5px;
            border-collapse: collapse;
            width: 910px;
        }

        .tab tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        .tab tr:hover {
            background-color: rgba(255, 182, 193, 0.2);
        }

        .tab th {
            padding: 5px;
            text-align: center;
            /*background-color: #04AA6D;*/
            background-color: firebrick;
            font-size: 12px;
            color: white;
            position: sticky;
            top: 0;
        }

    input {
        background-color: rgb(226,148,91,0.2)
    }

    select {
        background-color: rgb(226,148,91,0.2)
    }

    input:focus {
        background-color: rgba( 226,148,91, 0.6);
    }

    select:focus {
        background-color: rgba(226,148,91, 0.6);
    }

    .textHead {
        background-color: maroon;
        color: gold;
        font-family: 'Times New Roman';
        font-size: 13px;
        padding-top: 5px;
        padding-bottom: 5px
    }

    .divBorder {
        border: 1px solid gray;
    }

    .divText {
        font-size: 12px;
        font-weight: bold;
        background-color: white;
        z-index: 100;
        margin-top: -10px;
        color: firebrick;
        text-align: center
    }
    .tab2 {
        font-family: Arial, Helvetica, sans-serif;
        font-size: 12px;
        border-collapse: collapse;
        width: 850px;
        margin-left: auto;
        margin-right: auto;
    }

        .tab2 tbody {
            display: block;
            width: 850px;
            overflow: auto;
            height: 300px;
            text-align: center;
        }

        .tab2 td, .tab2 th {
            border: 1px solid #ddd;
            padding: 8px;
            border-collapse: collapse;
            width: 850px;
        }

        .tab2 tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        .tab2 tr:hover {
            background-color: rgba(255, 182, 193, 0.2);
        }

        .tab2 th {
            padding: 8px;
            text-align: center;
            /*background-color: #04AA6D;*/
            background-color: firebrick;
            font-size: 12px;
            color: white;
            position: sticky;
            top: 0;
        }
    *,
    *::before,
    *::after {
        box-sizing: border-box;
    }

    .section {
        position: relative;
    }

    [type="radio"]:checked,
    [type="radio"]:not(:checked) {
        position: absolute;
        left: -9999px;
    }

    .modal-btn:checked + label,
    .modal-btn:not(:checked) + label {
        /* position: relative;
        font-family: 'Poppins', sans-serif;
        font-weight: bold;
        font-size: 12px;
        line-height: 2;
        height: 30px;
        transition: all 200ms linear;
        border-radius: 4px;
        width: 140px;
        letter-spacing: 1px;
        display: -ms-inline-flexbox;
        display: inline-flex;
        -webkit-align-items: center;
        align-items: center;
        -webkit-justify-content: center;
        justify-content: center;
        -ms-flex-pack: center;
        text-align: center;
        -ms-flex-item-align: center;
        align-self: center;
        border: none;
        cursor: pointer;
        background-color: lightcoral;
        color: darkblue;
        box-shadow: 0 12px 35px 0 rgba(224,167,167,.25);*/
    }

        .modal-btn:not(:checked) + label:hover {
            /*  background-color: #ffeba7;
            color: #102770;*/
        }

        .modal-btn:checked + label .uil,
        .modal-btn:not(:checked) + label .uil {
            margin-left: 10px;
            font-size: 18px;
        }

        /* .modal-btn:checked + label:after,
    .modal-btn:not(:checked) + label:after {
        position: fixed;
        top: 90px;
        right: 30px;
        z-index: 110;
        width: 40px;
        border-radius: 3px;
        height: 30px;
        text-align: center;
        line-height: 30px;
        font-size: 15px;
        background-color: #ffeba7;
        color: #102770;
        content: ' \2573';
        box-shadow: 0 12px 25px 0 rgba(16,39,112,.25);
        transition: all 200ms linear;
        opacity: 0;
        pointer-events: none;
        transform: translateY(20px);
    }*/

        .modal-btn:checked + label:hover:after,
        .modal-btn:not(:checked) + label:hover:after {
            background-color: #102770;
            color: #ffeba7;
        }

        .modal-btn:checked + label:after {
            transition: opacity 300ms 300ms ease, transform 300ms 300ms ease, background-color 250ms linear, color 250ms linear;
            opacity: 1;
            pointer-events: auto;
            transform: translateY(0);
        }

    .modal {
        position: fixed;
        display: block;
        display: -ms-flexbox;
        display: flex;
        -ms-flex-wrap: wrap;
        flex-wrap: wrap;
        -ms-flex-pack: center;
        justify-content: center;
        margin: 0 auto;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 100;
        overflow-x: hidden;
        background-color: rgba(31,32,41,.75);
        pointer-events: none;
        opacity: 0;
        transition: opacity 250ms 700ms ease;
    }

    .modal-btn:checked ~ .modal {
        pointer-events: auto;
        opacity: 1;
        transition: all 300ms ease-in-out;
    }

    .modal-wrap {
        position: relative;
        display: block;
        width: 100%;
        max-width: 950px;
        padding: 10px;
        margin-left: 200px;
        margin-top: 180px;
        margin-bottom: 20px;
        border-radius: 4px;
        overflow: hidden;
        padding-bottom: 20px;
        background-color: #fff;
        -ms-flex-item-align: center;
        align-self: center;
        box-shadow: 0 12px 25px 0 rgba(199,175,189,.25);
        opacity: 0;
        transform: scale(0.6);
        transition: opacity 250ms 250ms ease, transform 300ms 250ms ease;
    }

        .modal-wrap img {
            display: block;
            width: 50px;
            height: 50px;
            margin: 20px auto;
        }

        .modal-wrap table {
            padding-left: 10px;
            padding-bottom: 5px;
            padding-right: 10px;
            text-align: justify;
        }

    .modal-btn:checked ~ .modal .modal-wrap {
        opacity: 1;
        transform: scale(1);
        transition: opacity 250ms 500ms ease, transform 350ms 500ms ease;
    }

    .modal-btn:checked ~ .logo img {
        filter: brightness(100%);
        transition: all 250ms linear;
    }

    @@media screen and (max-width: 500px) {
        .modal-wrap {
            width: calc(100% - 40px);
            padding-bottom: 15px;
        }

            .modal-wrap table {
                padding: 15px 20px 0 20px;
            }
    }

    .close-btn {
        /* position: absolute;
        top: 10px;
        right: 15px;*/
        font-size: 28px;
        font-weight: bold;
        color: firebrick;
        cursor: pointer;
    }

        .close-btn:hover {
            color: #ff0000;
        }
</style>
<form asp-controller="Member" asp-action="MemDepositeFundDetailList" method="post">
    <div class="container" style="height:70px">

    </div>
    <div class="heading mt-4">
        Member's Deposit Fund(GF/TF) Detail List
    </div>
    <div class="container mt-3">
        <div class="row justify-content-md-center">
            <div class="col-lg-12 col-md-12 col-sm-12 col-12 border border-1 rounded border-danger" style="width:1000px">
                <div class="row mt-2">
                    <div class="col-lg-3 col-md-3 col-sm-12 col-12">
                        Branch<br />
                        @Html.DropDownListFor(p => p.branch, new SelectList(Model.BranchDesc, "Value", "Text"), new { @class = "size"})
                    </div>
                    <div class="col-lg-3 col-md-3 col-sm-12 col-12">
                        G/L Account Head <br />
                        @Html.DropDownListFor(p => p.gl_achd, new SelectList(Model.achddesc, "Value", "Text"), "Select", new { @class = "size", @onchange = "gl_aconchange()" })
                    </div>
                    <div class="col-lg-3 col-md-3 col-sm-12 col-12">
                        As On Date<br />
                        @Html.TextBoxFor(p => p.on_dt, new { @class = "size", @type = "text", onkeypress = "javascript:return evton_dt(event);" })
                    </div>
                    <div class="col-lg-1 col-md-1 col-sm-12 col-12 mt-3">
                        <input id="BtnRefresh" type="button" name="BtnRefresh" Height="40" Width="100" class="btn btn-primary btn-sm" value="Refresh" onclick="ShowTableForGfTfList()" />
                    </div>
                    <div class="col-lg-1 col-md-1 col-sm-12 col-12 mt-3">
                        <input id="BtnPrint" type="button" name="BtnPrint" Height="40" Width="100" class="btn btn-primary btn-sm" value="Print" onclick="DownloadTextFilesForGFTFDetailList()"/>
                    </div>
                </div>
                @*<div class="container mt-2">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-12 text-center">
                        <img id="loading" src="~/wwwroot/Images/LoadingGif.gif" width="150" height="100" />
                        <div class="table-responsive">
                            <table id="GFTFList" class="tab">
                            </table>
                        </div>
                    </div>
                </div>*@
            <div class="container mt-2">
                <input class="modal-btn" type="radio" id="GfTfDiv-modal-btn" name="modal-btn" />
                <label for="GfTfDiv-modal-btn">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-12 text-center">
                        <img id="loading" src="~/wwwroot/Images/LoadingGif.gif" width="150" height="100" />
                        <div class="table-responsive">
                            <table id="GFTFList" class="tab">
                            </table>
                        </div>
                    </div>
                </label>
                <div class="modal" id="GfTfDiv-modal">
                    <div class="modal-wrap">

                        <div class="row mb-1">
                            <div class="col-lg-12 col-md-12 col-sm-12 col-12 text-center p-1" style="background-color:lightcoral;color:white;text-transform:uppercase" id="gf_head">
                                Guarantee Fund Ledger
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12 col-12 text-center p-1" style="background-color:lightcoral;color:white;text-transform:uppercase" id="tf_head">
                                Thrift Fund Ledger
                            </div>
                        </div>
                        <div class="row mt-1 mb-1">
                            <div class="col-lg-1 col-md-1 col-sm-12 col-12">

                            </div>
                            <div class="col-lg-3 col-md-2 col-sm-12 col-12">
                                Branch<br />
                                @Html.TextBoxFor(p => p.brn_txtbox, new { @class = "size", @type = "text", @readonly = "true" })
                            </div>
                            <div class="col-lg-3 col-md-2 col-sm-12 col-12">
                                Member NO.<br />
                                @Html.TextBoxFor(p => p.mem_no, new { @class = "size", @type = "text", @readonly = "true" })
                            </div>
                            <div class="col-lg-4 col-md-4 col-sm-12 col-12">
                                Name<br />
                                @Html.TextBoxFor(p => p.mem_name, new { @class = "sizebig", @type = "text", @readonly = "true" })
                            </div>
                            <div class="col-lg-1 col-md-1 col-sm-12 col-12">
                                <span class="close-btn" onclick="document.getElementById('GfTfDiv-modal-btn').checked = false;">&times;</span>
                            </div>
                        </div>
                        <table id="ledgerdetails_gf" class="bordered table-responsive tab2">
                        </table>
                        <table id="ledgerdetails_tf" class="bordered table-responsive tab2">
                        </table>
                    </div>
                </div>
            </div>
                <div class="row mt-2 mb-1">
                    <div class="col-lg-2 col-md-2 col-sm-12 col-12" id="close" style="background-color: saddlebrown; color: floralwhite; font-size: 14px; font-weight: bold; text-align: center">
                        << Summary >>
                    </div>
                    <div class="col-lg-10 col-md-10 col-sm-12 col-12" style="background-color:burlywood;color:brown">
                        <div class="row mt-1 mb-1">
                            <div class="col-lg-3 col-sm-12 col-12">

                            </div>
                            <div class="col-lg-3 col-sm-12 col-12 text-center">
                                @Html.TextBoxFor(model => model.prnt_bal, new { @class = "size2", @type = "text" })
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12 text-center">
                                @Html.TextBoxFor(model => model.int_bal, new { @class = "size2", @type = "text" })
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12 text-center">
                                @Html.TextBoxFor(model => model.tot_bal, new { @class = "size2", @type = "text" })
                            </div>
                        </div>

                    </div>

                </div>
                <div class="row mt-1">
                   
                            <div class="col-lg-3 col-sm-12 col-12">
                                @Html.TextBoxFor(model => model.mem_id, new { @class = "size2", @type = "hidden"  })
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                @Html.TextBoxFor(model => model.mem_name_txt, new { @class = "size2", @type = "hidden" })
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                @Html.TextBoxFor(model => model.table, new { @class = "size2", @type = "hidden" })
                            </div>                        
                </div>
            </div>
        </div>
    </div>
</form>


@section scripts
{
    <script type="text/javascript" src="~/Content/lib/bootstrap/dist/js/bootstrap-datepicker.js"></script>
    <script type="text/javascript" src="~/Scripts/jquery-3.4.1.min.js"></script>
    <script type="text/javascript">

        $(document).ready(function () {
            $("#loading").hide();
            $("#gl_achd").focus();
        });

        function ShowTableForGfTfList() {
            if ($('#on_dt').val() == null || $('#on_dt').val() == "") {
                    alert("Invalid Date Supplied");
            }
            else if ($('#gl_achd').val() == "" || $('#gl_achd').val() == "Select" ) {
                    alert("Please Choose Account Head");
            }
            else {
                    $("#loading").show();
                    let ModelObject = { branch: $('#branch').val(), gl_achd: $('#gl_achd').val(), on_dt: $('#on_dt').val()};
                    $.ajax({
                    type: "POST",
                         url: '@Url.Action("GetGFTFDetailList", "Member")',
                        data: ModelObject,
                        dataType: "json",
                        success: function (data) {
                        $("#loading").hide();
                        document.getElementById("GFTFList").innerHTML = data.tableelement;
                        $('#prnt_bal').val(data.prnt_bal);
                        $('#int_bal').val(data.int_bal);
                        $('#tot_bal').val(data.tot_bal);
                    },
                     error: function (err) {
                    //alert("Error Occured");
                     }
                    });
                 }
        }

        (function () {
            if (window.addEventListener) {
                window.addEventListener('load', runformemberfund, false);
            }
            else if (window.attachEvent) {
                window.attachEvent('onload', runformemberfund);
            }
            function runformemberfund() {
                var t = document.getElementById('GFTFList');
                t.onclick = function (event) {
                    event = event || window.event;
                    var target = event.target || event.srcElement;
                    while (target && target.nodeName != 'TR') {
                        target = target.parentElement;
                    }
                    var cells = target.cells;
                    if (!cells.length || target.parentNode.nodeName == 'THEAD') {
                        return;
                    }
                    var f1 = document.getElementById('mem_id');
                    var f2 = document.getElementById('mem_name_txt');

                    f1.value = cells[1].innerHTML;
                    f2.value = cells[3].innerHTML;
                    ShowLedgerTable();
                };
            }
        })();

        function ShowLedgerTable() {
            if ($('#gl_achd').val() == "GF") {
                $('#table').val("GF_LEDGER");
            }
            if ($('#gl_achd').val() == "TF") {
                $('#table').val("TF_LEDGER");
            }
            let ModelObject = { BranchID: $('#branch').val(), member_no: $('#mem_id').val(), table: $('#table').val(), emp_id: $('#emp_id').val(), ac_hd: $('#gl_achd').val(), name: $('#mem_name_txt').val()};
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("getledgerbymemid", "Member")',
                    data: ModelObject,
                    dataType: "json",
                    success: function (data) {
                        if ($('#table').val() == "GF_LEDGER") {
                            document.getElementById("ledgerdetails_gf").innerHTML = data.tableelement;
                            $("#ledgerdetails_gf").show();
                            $("#gf_head").show();
                            $("#ledgerdetails_tf").hide();
                            $("#tf_head").hide();
                            $('#brn_txtbox').val(data.Branch);
                            $('#mem_no').val(data.mem_no);
                            $('#mem_name').val(data.mem_name);
                        }
                        if ($('#table').val() == "TF_LEDGER") {
                            document.getElementById("ledgerdetails_tf").innerHTML = data.tableelement;
                            $("#ledgerdetails_tf").show();
                            $("#tf_head").show();
                            $("#ledgerdetails_gf").hide();
                            $("#gf_head").hide();
                            $('#brn_txtbox').val(data.Branch);
                            $('#mem_no').val(data.mem_no);
                            $('#mem_name').val(data.mem_name);
                        }
                    },
                    error: function (err) {

                    }
                });
        }

        function DownloadTextFilesForGFTFDetailList() {
            window.location.href = "@Url.Action("GFTFDetailsPrintfile", "Member")" + "?branch=" + $('#branch').val() + "&gl_achd=" + $('#gl_achd').val() + "&on_dt=" + $('#on_dt').val();
        }
       
        function gl_aconchange() {
            $("#on_dt").focus();
        }
       
        function evton_dt(evt) {
            var charCode = (evt.which) ? evt.which : event.keyCode;
            if ((charCode < 106 || charCode > 95) && (charCode < 58 || charCode > 47) && charCode != 13 && charCode == 191 && charCode == 111 && (charCode < 65 || charCode > 90))
                return false;
            else if (charCode == 13) {
                $("#BtnRefresh").focus();
            }
        }

    </script>
}

